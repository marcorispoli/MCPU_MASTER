.TH "CanOpenModuleProtected" 3 "Mon Sep 30 2024" "MCPU" \" -*- nroff -*-
.ad l
.nh
.SH NAME
CanOpenModuleProtected \- Protected Interface (Subclass reserved)
.SH SYNOPSIS
.br
.PP
.SS "Functions"

.in +1c
.ti -1c
.RI "int \fBCANOPEN::CanOpenMotor::getPreviousPosition\fP (void)"
.br
.RI "This function returns the previous position before the last activation execution\&. "
.ti -1c
.RI "void \fBCANOPEN::CanOpenMotor::setNanoJPtr\fP (const unsigned char *ptr, int size)"
.br
.RI "This function assignes the binary pointer of the nano-j program to be uploaded during the configuration fase\&. "
.ti -1c
.RI "int \fBCANOPEN::CanOpenMotor::getCurrentEncoderEposition\fP (void)"
.br
.RI "This function returns the current encoder position in Encoder internal units "
.ti -1c
.RI "int \fBCANOPEN::CanOpenMotor::getCurrentEncoderUposition\fP (void)"
.br
.ti -1c
.RI "int \fBCANOPEN::CanOpenMotor::getCurrentUposition\fP (void)"
.br
.RI "This function returns the current user defined position "
.ti -1c
.RI "void \fBCANOPEN::CanOpenMotor::setTargetRange\fP (int h, int l)"
.br
.RI "This function set the current acceptable position range\&. "
.ti -1c
.RI "bool \fBCANOPEN::CanOpenMotor::isEncoderInitialized\fP (void)"
.br
.RI "This function returns the current encoder zero setting status "
.ti -1c
.RI "void \fBCANOPEN::CanOpenMotor::setEncoderInitStatus\fP (bool val)"
.br
.RI "This function allows the subclass to set the current zero setting status "
.ti -1c
.RI "int \fBCANOPEN::CanOpenMotor::convert_Encoder_To_User\fP (int x)"
.br
.RI "This function translate internal encoder position to the unit position value "
.ti -1c
.RI "int \fBCANOPEN::CanOpenMotor::convert_Absolute_Encoder_To_User\fP (int x)"
.br
.RI "This function translate internal encoder position to the unit position value "
.ti -1c
.RI "int \fBCANOPEN::CanOpenMotor::convert_User_To_Encoder\fP (int x)"
.br
.RI "This function translate the user position to the encoder position "
.ti -1c
.RI "int \fBCANOPEN::CanOpenMotor::convert_Absolute_User_To_Encoder\fP (int x)"
.br
.ti -1c
.RI "int \fBCANOPEN::CanOpenMotor::convert_UserSec_To_Speed\fP (int x)"
.br
.RI "This function is used to transform the user defined speed or acceleration into the SPeed or Acceleration internal encoder units "
.ti -1c
.RI "bool \fBCANOPEN::CanOpenMotor::blocking_writeOD\fP (unsigned short index, unsigned char sub, \fBODRegister::SDODataDimension\fP dim, int val)"
.br
.RI "This function writes a SDO register in the target motor device; "
.ti -1c
.RI "void \fBCANOPEN::CanOpenMotor::write_resetNode\fP (void)"
.br
.RI "This function sends a Reset Node command to the device\&. "
.ti -1c
.RI "bool \fBCANOPEN::CanOpenMotor::blocking_readOD\fP (unsigned short index, unsigned char sub, \fBODRegister::SDODataDimension\fP dim)"
.br
.RI "This function Reads a SDO register in the target motor device; "
.ti -1c
.RI "bool \fBCANOPEN::CanOpenMotor::writeControlWord\fP (unsigned int mask, unsigned int val)"
.br
.RI "This function writes a part of the control word\&. "
.ti -1c
.RI "bool \fBCANOPEN::CanOpenMotor::readControlWord\fP (unsigned int *ctrlw)"
.br
.RI "This function reads the control word\&. "
.ti -1c
.RI "bool \fBCANOPEN::CanOpenMotor::readStatusWord\fP (unsigned int *stw)"
.br
.RI "This function reads the status word\&. "
.ti -1c
.RI "bool \fBCANOPEN::CanOpenMotor::startRotation\fP (void)"
.br
.RI "This function starts the motor rotation\&. "
.ti -1c
.RI "bool \fBCANOPEN::CanOpenMotor::startNanoj\fP (void)"
.br
.RI "This function runs the Nano-J program on the Motor Device "
.ti -1c
.RI "bool \fBCANOPEN::CanOpenMotor::stopNanoj\fP (void)"
.br
.RI "This function stops a running Nano-J program\&. "
.ti -1c
.RI "static System::String ^ \fBCANOPEN::CanOpenMotor::getErrorClass1001\fP (unsigned int val)"
.br
.RI "This is a convenient function to decode a Error string from the error of the register 1001\&. "
.ti -1c
.RI "static System::String ^ \fBCANOPEN::CanOpenMotor::getErrorClass1003\fP (unsigned int val)"
.br
.RI "This is a convenient function to decode a Error Class string from the register 1003\&. "
.ti -1c
.RI "static System::String ^ \fBCANOPEN::CanOpenMotor::getErrorCode1003\fP (unsigned int val)"
.br
.RI "This is a convenient function to decode a Error Code string from the register 1003\&. "
.ti -1c
.RI "virtual void \fBCANOPEN::CanOpenMotor::motionParameterCallback\fP (\fBMotorCommands\fP current_command, int current_position, int target_position)"
.br
.ti -1c
.RI "virtual \fBMotorCompletedCodes\fP \fBCANOPEN::CanOpenMotor::preparationCallback\fP (\fBMotorCommands\fP current_command, int current_position, int target_position)"
.br
.RI "This function is called just before to set the speed: if return true, the speed is set to the predefined value\&. "
.ti -1c
.RI "virtual \fBMotorCompletedCodes\fP \fBCANOPEN::CanOpenMotor::runningCallback\fP (\fBMotorCommands\fP current_command, int current_position, int target_position)"
.br
.RI "This function is called just before to Power the motor phases\&. "
.ti -1c
.RI "virtual void \fBCANOPEN::CanOpenMotor::completedCallback\fP (int id, \fBMotorCommands\fP current_command, int current_position, \fBMotorCompletedCodes\fP term_code)"
.br
.RI "This function is called just before to Power the motor phases\&. "
.ti -1c
.RI "virtual \fBMotorCompletedCodes\fP \fBCANOPEN::CanOpenMotor::idleCallback\fP (void)"
.br
.RI "This function is called just before to Power the motor phases\&. "
.ti -1c
.RI "virtual void \fBCANOPEN::CanOpenMotor::faultCallback\fP (bool errstat, bool data_change, unsigned int error_class, unsigned int error_code)"
.br
.ti -1c
.RI "virtual void \fBCANOPEN::CanOpenMotor::resetCallback\fP (void)"
.br
.RI "Called whenever the boot message is received from the device\&. "
.ti -1c
.RI "virtual unsigned short \fBCANOPEN::CanOpenMotor::initializeSpecificObjectDictionaryCallback\fP (void)"
.br
.RI "Override this function to initialize specific registers of the target Motor Device\&. "
.ti -1c
.RI "virtual bool \fBCANOPEN::CanOpenMotor::unbrakeCallback\fP (void)"
.br
.RI "Called whenever the optional brake device should be released\&. "
.ti -1c
.RI "virtual bool \fBCANOPEN::CanOpenMotor::brakeCallback\fP (void)"
.br
.RI "Called whenever the optional brake device should be reactivated 
.br
 "
.ti -1c
.RI "void \fBCANOPEN::CanOpenMotor::setCommandCompleted\fP (\fBMotorCompletedCodes\fP error)"
.br
.ti -1c
.RI "int \fBCANOPEN::CanOpenMotor::getCommandId\fP (void)"
.br
.RI "This function returns the current command-id\&. "
.ti -1c
.RI "\fBODRegister\fP ^ \fBCANOPEN::CanOpenMotor::getRxReg\fP (void)"
.br
.RI "Returns the pointer of the reception sdo register "
.in -1c
.SH "Detailed Description"
.PP 


This section describes the API for subclass modules\&.
.SH "Function Documentation"
.PP 
.SS "bool CanOpenMotor::blocking_readOD (unsigned short index, unsigned char sub, \fBODRegister::SDODataDimension\fP dim)\fC [protected]\fP"

.PP
This function Reads a SDO register in the target motor device; The function sends to the CAN Bus the command to read the target register, then waits the answer\&. In case of no answer, tries 5 times before to fail\&.
.PP
\fBParameters\fP
.RS 4
\fIindex\fP Index of the register
.br
\fIsub\fP Sub index of the register
.br
\fIdim\fP Dimension code of the data register
.RE
.PP
\fBReturns\fP
.RS 4
true in case of success
.RE
.PP

.SS "bool CanOpenMotor::blocking_writeOD (unsigned short index, unsigned char sub, \fBODRegister::SDODataDimension\fP dim, int val)\fC [protected]\fP"

.PP
This function writes a SDO register in the target motor device; The function sends to the CAN Bus the command to write the target register, then waits the answer\&. In case of no answer, tries 5 times before to fail\&.
.PP
\fBParameters\fP
.RS 4
\fIindex\fP Index of the register
.br
\fIsub\fP Sub index of the register
.br
\fIdim\fP Dimension code of the data register
.br
\fIval\fP Value to be written into register
.RE
.PP
\fBReturns\fP
.RS 4
true in case of success
.RE
.PP

.SS "virtual bool CANOPEN::CanOpenMotor::brakeCallback (void)\fC [inline]\fP, \fC [protected]\fP, \fC [virtual]\fP"

.PP
Called whenever the optional brake device should be reactivated 
.br
 
.PP
Reimplemented in \fBBodyMotor\fP, and \fBTiltMotor\fP\&.
.SS "virtual void CANOPEN::CanOpenMotor::completedCallback (int id, \fBMotorCommands\fP current_command, int current_position, \fBMotorCompletedCodes\fP term_code)\fC [inline]\fP, \fC [protected]\fP, \fC [virtual]\fP"

.PP
This function is called just before to Power the motor phases\&. 
.PP
Reimplemented in \fBArmMotor\fP, \fBSlideMotor\fP, \fBTiltMotor\fP, and \fBVerticalMotor\fP\&.
.SS "int CanOpenMotor::convert_Absolute_Encoder_To_User (int x)\fC [protected]\fP"

.PP
This function translate internal encoder position to the unit position value This function makes use of the rotation/Unit factor the subclass passes to the module constructor in order to define what will be the user position unit\&.
.PP
The value can be positive or negative based on the current direction selected in the motor constructor\&.
.PP
\fBParameters\fP
.RS 4
\fIx\fP the encoder internal position
.RE
.PP
\fBReturns\fP
.RS 4
the user position 
.RE
.PP

.SS "int CanOpenMotor::convert_Absolute_User_To_Encoder (int x)\fC [protected]\fP"
This function translate the user position to the encoder position without the direction correction\&.
.PP
This function makes use of the rotation/Unit factor the subclass passes to the module constructor in order to define what will be the user position unit\&.
.PP
\fBParameters\fP
.RS 4
\fIx\fP the user position
.RE
.PP
\fBReturns\fP
.RS 4
the encoder position 
.RE
.PP

.SS "int CanOpenMotor::convert_Encoder_To_User (int x)\fC [protected]\fP"

.PP
This function translate internal encoder position to the unit position value This function convert the Encoder units to Application (user) units\&.
.PP
This function makes use of the rotation/Unit factor the subclass passes to the module constructor in order to define what will be the user position unit\&.
.PP
\fBParameters\fP
.RS 4
\fIx\fP the encoder internal position
.RE
.PP
\fBReturns\fP
.RS 4
the user position 
.RE
.PP
.PP
This function is the reverse of the \fBconvert_User_To_Encoder()\fP function and it shall be used whenever the actual position should be read from the motor device\&.
.PP
\fBParameters\fP
.RS 4
\fIx\fP 
.RE
.PP
\fBReturns\fP
.RS 4
The position in application units (user units)
.RE
.PP

.SS "int CanOpenMotor::convert_User_To_Encoder (int x)\fC [protected]\fP"

.PP
This function translate the user position to the encoder position This function allows to convert the User units to Encoder units\&.
.PP
This function makes use of the rotation/Unit factor the subclass passes to the module constructor in order to define what will be the user position unit\&.
.PP
The value can be positive or negative based on the current direction selected in the motor constructor\&.
.PP
\fBParameters\fP
.RS 4
\fIx\fP the user position
.RE
.PP
\fBReturns\fP
.RS 4
the encoder position 
.RE
.PP
.PP
Whenever the application needs to write a Motor register with a position, the motor register needs the Encoder value\&. This function allows to use application units instead of Encoder unit\&.
.PP
The application sets the application-unit in the Constructor function, assigning the value of the (double) rot_per_unit parameter with the formula: rot_per_unit = Rounds/units\&.
.PP
For example, if the Application should make use of 1 unit corresponding to be 0\&.01°, and 1 unit should correspond to 10 rounds, the rot_per_unit = 10/1\&.
.PP
\fBParameters\fP
.RS 4
\fIx\fP 
.RE
.PP
\fBReturns\fP
.RS 4
The position in Encoder units (motor units)
.RE
.PP

.SS "int CanOpenMotor::convert_UserSec_To_Speed (int x)\fC [protected]\fP"

.PP
This function is used to transform the user defined speed or acceleration into the SPeed or Acceleration internal encoder units This function converts a speed expressed in Application units/second to Motor units/second\&.
.PP
\fBParameters\fP
.RS 4
\fIx\fP this is the user speed or acceleration (units/s or units/ss) 
.RE
.PP
\fBReturns\fP
.RS 4
the encoder unit format
.RE
.PP
.PP
Always the speed or accelerations register shall be written, the units shall be expressed in motor units\&. This function is a convenient convertion function allowing to use more comprensible Application units\&.
.PP
\fBParameters\fP
.RS 4
\fIx\fP 
.RE
.PP
\fBReturns\fP
.RS 4
The Speed or Acceleration ratio in motor units
.RE
.PP

.SS "int CANOPEN::CanOpenMotor::getCommandId (void)\fC [inline]\fP, \fC [protected]\fP"

.PP
This function returns the current command-id\&. The command-id is passed by the application when requesting a command execution\&. The command-id is returned in the command_completed_event to the application\&.
.PP
\fBReturns\fP
.RS 4
the command_id internal code
.RE
.PP

.SS "int CANOPEN::CanOpenMotor::getCurrentEncoderEposition (void)\fC [inline]\fP, \fC [protected]\fP"

.PP
This function returns the current encoder position in Encoder internal units 
.PP
\fBReturns\fP
.RS 4
The current encoder position in Internal encoder units
.RE
.PP

.SS "int CANOPEN::CanOpenMotor::getCurrentUposition (void)\fC [inline]\fP, \fC [protected]\fP"

.PP
This function returns the current user defined position The user defined position is the position of the external sensor if it should be configured\&.
.PP
\fBReturns\fP
.RS 4
The current encoder position in user units
.RE
.PP

.SS "System::String CanOpenMotor::getErrorClass1001 (unsigned int val)\fC [static]\fP, \fC [protected]\fP"

.PP
This is a convenient function to decode a Error string from the error of the register 1001\&. 
.PP
\fBParameters\fP
.RS 4
\fIval\fP Register 1001 error code
.RE
.PP
\fBReturns\fP
.RS 4
.RE
.PP

.SS "System::String CanOpenMotor::getErrorClass1003 (unsigned int val)\fC [static]\fP, \fC [protected]\fP"

.PP
This is a convenient function to decode a Error Class string from the register 1003\&. 
.PP
\fBParameters\fP
.RS 4
\fIval\fP 
.RE
.PP
\fBReturns\fP
.RS 4
.RE
.PP

.SS "System::String CanOpenMotor::getErrorCode1003 (unsigned int val)\fC [static]\fP, \fC [protected]\fP"

.PP
This is a convenient function to decode a Error Code string from the register 1003\&. 
.PP
\fBParameters\fP
.RS 4
\fIval\fP 
.RE
.PP
\fBReturns\fP
.RS 4
.RE
.PP

.SS "int CANOPEN::CanOpenMotor::getPreviousPosition (void)\fC [inline]\fP, \fC [protected]\fP"

.PP
This function returns the previous position before the last activation execution\&. The function provides the application the method to manage variation in positions\&.
.PP
\fBReturns\fP
.RS 4
The previous valid position in user units
.RE
.PP

.SS "\fBODRegister\fP ^ CANOPEN::CanOpenMotor::getRxReg (void)\fC [inline]\fP, \fC [protected]\fP"

.PP
Returns the pointer of the reception sdo register 
.PP
\fBReturns\fP
.RS 4

.RE
.PP

.SS "virtual \fBMotorCompletedCodes\fP CANOPEN::CanOpenMotor::idleCallback (void)\fC [inline]\fP, \fC [protected]\fP, \fC [virtual]\fP"

.PP
This function is called just before to Power the motor phases\&. 
.PP
Reimplemented in \fBBodyMotor\fP, \fBTiltMotor\fP, and \fBVerticalMotor\fP\&.
.SS "virtual unsigned short CANOPEN::CanOpenMotor::initializeSpecificObjectDictionaryCallback (void)\fC [inline]\fP, \fC [protected]\fP, \fC [virtual]\fP"

.PP
Override this function to initialize specific registers of the target Motor Device\&. 
.PP
Reimplemented in \fBArmMotor\fP, \fBBodyMotor\fP, \fBSlideMotor\fP, \fBTiltMotor\fP, and \fBVerticalMotor\fP\&.
.SS "bool CANOPEN::CanOpenMotor::isEncoderInitialized (void)\fC [inline]\fP, \fC [protected]\fP"

.PP
This function returns the current encoder zero setting status 
.PP
\fBReturns\fP
.RS 4
true if a valid encoder position is present
.RE
.PP

.SS "virtual \fBMotorCompletedCodes\fP CANOPEN::CanOpenMotor::preparationCallback (\fBMotorCommands\fP current_command, int current_position, int target_position)\fC [inline]\fP, \fC [protected]\fP, \fC [virtual]\fP"

.PP
This function is called just before to set the speed: if return true, the speed is set to the predefined value\&. 
.PP
Reimplemented in \fBTiltMotor\fP, and \fBVerticalMotor\fP\&.
.SS "bool CanOpenMotor::readControlWord (unsigned int * ctrlw)\fC [protected]\fP"

.PP
This function reads the control word\&. 
.PP
\fBParameters\fP
.RS 4
\fIctrlw\fP This is the pointer to the variable where the control word will be copied in
.RE
.PP
\fBReturns\fP
.RS 4
true if the register is successfully read
.RE
.PP

.SS "bool CanOpenMotor::readStatusWord (unsigned int * stw)\fC [protected]\fP"

.PP
This function reads the status word\&. 
.PP
\fBParameters\fP
.RS 4
\fIstw\fP This is the pointer to the status word
.RE
.PP
\fBReturns\fP
.RS 4
true if the register is successfully read
.RE
.PP

.SS "virtual void CANOPEN::CanOpenMotor::resetCallback (void)\fC [inline]\fP, \fC [protected]\fP, \fC [virtual]\fP"

.PP
Called whenever the boot message is received from the device\&. 
.PP
Reimplemented in \fBTiltMotor\fP\&.
.SS "virtual \fBMotorCompletedCodes\fP CANOPEN::CanOpenMotor::runningCallback (\fBMotorCommands\fP current_command, int current_position, int target_position)\fC [inline]\fP, \fC [protected]\fP, \fC [virtual]\fP"

.PP
This function is called just before to Power the motor phases\&. 
.PP
Reimplemented in \fBBodyMotor\fP, and \fBVerticalMotor\fP\&.
.SS "void CANOPEN::CanOpenMotor::setEncoderInitStatus (bool val)\fC [inline]\fP, \fC [protected]\fP"

.PP
This function allows the subclass to set the current zero setting status The device after startup reset the zero setting flag, until a zero setting procedure is executed\&.
.PP
Without a valid zero setting, any the activation command is rejected\&.
.PP
However the subclass can implement a strategy to recover the actual real position without executing a zero setting activation\&. In this case the subclass can set this flag allowing to execute further commands\&.
.PP
\fBReturns\fP
.RS 4
.RE
.PP

.SS "void CANOPEN::CanOpenMotor::setNanoJPtr (const unsigned char * ptr, int size)\fC [inline]\fP, \fC [protected]\fP"

.PP
This function assignes the binary pointer of the nano-j program to be uploaded during the configuration fase\&. The subclass should set this pointer at the beginning i the subclass constructor in order to let the module to upload the program into the driver device\&.
.PP
\fBParameters\fP
.RS 4
\fIptr\fP this is the pointer of the program byte array
.br
\fIsize\fP this is the size of the program in bytes
.RE
.PP

.SS "void CANOPEN::CanOpenMotor::setTargetRange (int h, int l)\fC [inline]\fP, \fC [protected]\fP"

.PP
This function set the current acceptable position range\&. The activation command is rejected if the target position should be out of the acceptable range\&.
.PP
As default, the acceptable range is 0 (no command can be executed)
.PP
The Subclass should set this range to define the specific activation range\&.
.PP
\fBParameters\fP
.RS 4
\fIh\fP 
.br
\fIl\fP 
.RE
.PP

.SS "bool CanOpenMotor::startNanoj (void)\fC [protected]\fP"

.PP
This function runs the Nano-J program on the Motor Device If the Nanoj-Program has been uploaded into the device this function tries to run it\&.
.PP
If a program is already in execution the function tries to stop it and restart again\&.
.PP
In case of error in running the program the function fails\&.
.PP
\fBReturns\fP
.RS 4
true if the program successfully starts
.RE
.PP

.SS "bool CanOpenMotor::startRotation (void)\fC [protected]\fP"

.PP
This function starts the motor rotation\&. The function activates the BIT-4 of the control word: this bit starts the motor rotation for the Positioning Mode\&.
.PP
\fBReturns\fP
.RS 4
.RE
.PP

.SS "bool CanOpenMotor::stopNanoj (void)\fC [protected]\fP"

.PP
This function stops a running Nano-J program\&. 
.PP
\fBReturns\fP
.RS 4
true if the program is successfully stopped
.RE
.PP

.SS "virtual bool CANOPEN::CanOpenMotor::unbrakeCallback (void)\fC [inline]\fP, \fC [protected]\fP, \fC [virtual]\fP"

.PP
Called whenever the optional brake device should be released\&. 
.PP
Reimplemented in \fBBodyMotor\fP, and \fBTiltMotor\fP\&.
.SS "void CanOpenMotor::write_resetNode (void)\fC [protected]\fP"

.PP
This function sends a Reset Node command to the device\&. NOTE: after the reset, the Motor device not responds to the command and takes seconds before to be ready for a communication!
.SS "bool CanOpenMotor::writeControlWord (unsigned int mask, unsigned int val)\fC [protected]\fP"

.PP
This function writes a part of the control word\&. The function uses a masj to filter what are the bits to be written with the value;
.PP
\fBParameters\fP
.RS 4
\fImask\fP Select the bit of the control word to be modified
.br
\fIval\fP Set the value in the selected bits of the control word
.RE
.PP
\fBReturns\fP
.RS 4
true if success
.RE
.PP

.SH "Author"
.PP 
Generated automatically by Doxygen for MCPU from the source code\&.
